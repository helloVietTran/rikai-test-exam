<h1 class="mb-4 fs-2">Danh sách công ty</h1>
<a href="/companies/add" class="btn btn-primary mb-3">+ Thêm công ty</a>

<table class="table table-bordered table-hover">
  <thead class="table-light">
    <tr>
      <th>ID</th>
      <th>Tên</th>
      <th>Địa chỉ</th>
      <th>Thời gian tạo</th>
      <th>Hành động</th>
    </tr>
  </thead>
  <tbody>
    <% companies.forEach(c => { %>
    <tr>
      <td><%= c.id %></td>
      <td><%= c.name %></td>
      <td><%= c.address %></td>
      <td><%= formatDateTime(c.created_at) %></td>
      <td>
        <a href="/companies/edit/<%= c.id %>" class="btn btn-warning btn-sm"
          >Sửa</a
        >
        <button
          type="button"
          class="btn btn-danger btn-sm"
          data-id="<%= c.id %>"
          onclick="handleDelete(this)"
        >
          Xóa
        </button>
      </td>
    </tr>
    <% }) %>
  </tbody>
</table>

<!-- PHÂN TRANG -->
<nav aria-label="Page navigation">
  <ul class="pagination justify-content-center">
    <% for (let i = 1; i <= totalPages; i++) { %>
    <li class="page-item <%= i === currentPage ? 'active' : '' %>">
      <a class="page-link" href="?page=<%= i %>"><%= i %></a>
    </li>
    <% } %>
  </ul>
</nav>

<%- include('../partials/delete-modal') %>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  const deleteModal = new bootstrap.Modal(
    document.getElementById("deleteModal")
  );
  const confirmDeleteBtn = document.getElementById("confirmDeleteBtn");

  function handleDelete(btn) {
    const id = btn.getAttribute("data-id");
    confirmDeleteBtn.href = `/companies/delete/${id}`;
    deleteModal.show();
  }
</script>
