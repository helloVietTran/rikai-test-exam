<h1 class="fs-2 mb-4">Sửa người dùng</h1>

<% if (error) { %>
  <div class="alert alert-danger"><%= error %></div>
<% } %>

<form method="POST" action="/users/edit/<%= user.id %>" id="editUserForm" novalidate>
  <div class="mb-3">
    <label for="name" class="form-label">Tên</label>
    <input
      type="text"
      id="name"
      name="name"
      class="form-control"
      value="<%= user.name %>"
      required
    />
    <div class="invalid-feedback">Vui lòng nhập tên người dùng.</div>
  </div>

  <div class="mb-3">
    <label for="email" class="form-label">Email</label>
    <input
      type="email"
      id="email"
      name="email"
      class="form-control"
      value="<%= user.email %>"
      required
    />
    <div class="invalid-feedback">Vui lòng nhập email hợp lệ.</div>
  </div>

  <div class="mb-3">
    <label for="company_id" class="form-label">Công ty</label>
    <select id="company_id" name="company_id" class="form-select" required>
      <option value="">-- Chọn công ty --</option>
      <% companies.forEach(c => { %>
        <option
          value="<%= c.id %>"
          <%= c.id === user.company_id ? 'selected' : '' %>>
          <%= c.name %>
        </option>
      <% }) %>
    </select>
    <div class="invalid-feedback">Vui lòng chọn công ty.</div>
  </div>

  <button type="submit" class="btn btn-success">Cập nhật</button>
</form>

<script>
  (() => {
    const form = document.getElementById('editUserForm');
    form.addEventListener('submit', (e) => {
      if (!form.checkValidity()) {
        e.preventDefault();
        e.stopPropagation();
      }
      form.classList.add('was-validated');
    });
  })();
</script>
